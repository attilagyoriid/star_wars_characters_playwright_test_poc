pipeline {
    agent {
        docker {
            image 'mcr.microsoft.com/playwright:v1.40.0-focal'
            args """
                --ipc=host 
                -e HOME=/root 
                -e CI=true
                -w /workspace
                -v "${env.WORKSPACE ?: '/tmp/workspace'}:/workspace"
            """
        }
    }

    environment {
        HOME = '.'  
        CI = 'true'
        TEST_DIR = 'playwright-test'
        LOG_FILE = 'jenkins.log'
        GITHUB_SSH_KEY = credentials('github credentials')
        GIT_REPO_URL = 'git@github.com:attilagyoriid/star_wars_characters_playwright_test_poc.git'
        GIT_BRANCH = 'main'
        WORKSPACE = "${env.WORKSPACE ?: '/tmp/workspace'}"
    }

    stages {
        stage('Checkout') {
            steps {
                checkout([$class: 'GitSCM', branches: [[name: "${env.GIT_BRANCH}"]],
                          userRemoteConfigs: [[url: "${env.GIT_REPO_URL}"]]])
            }
        }
        stage('List Files') {
            steps {
                sh 'ls -la'
            }
        }
    }
}